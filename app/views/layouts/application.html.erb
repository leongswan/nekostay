<!DOCTYPE html>
<html>
  <head>
    <title>Nekostay</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
  </head>

  <body>
    <header style="background: white; border-bottom: 1px solid #eee; padding: 10px 20px; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 100;">
      <div style="font-size: 1.5rem; font-weight: bold; color: #D98E63; display: flex; align-items: center; gap: 10px;">
        <%= link_to root_path, style: "text-decoration: none; color: inherit; display: flex; align-items: center; gap: 8px;" do %>
          <i class="fa-solid fa-cat"></i>
          <span>Nekostay</span>
        <% end %>
      </div>

      <div style="display: flex; align-items: center; gap: 20px;">
        <% if user_signed_in? %>
          <%= link_to edit_user_registration_path, style: "text-decoration: none; color: #555; display: flex; align-items: center; gap: 10px; font-weight: bold; font-size: 0.9rem;" do %>
            <% if current_user.image.attached? %>
              <%= image_tag current_user.image, style: "width: 35px; height: 35px; border-radius: 50%; object-fit: cover; border: 2px solid #eee;" %>
            <% else %>
              <div style="width: 35px; height: 35px; background: #ddd; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white;">
                <i class="fa-solid fa-user"></i>
              </div>
            <% end %>
            <span style="display: none; sm:inline;"><%= current_user.name %></span>
          <% end %>

          <%= button_to destroy_user_session_path, method: :delete, style: "background: none; border: none; cursor: pointer; color: #999; font-size: 1.2rem; padding: 5px;", title: "ログアウト" do %>
            <i class="fa-solid fa-right-from-bracket"></i>
          <% end %>

        <% else %>
          <%= link_to "ログイン", new_user_session_path, style: "color: #555; text-decoration: none; font-weight: bold;" %>
          <%= link_to "新規登録", new_user_registration_path, style: "background: #D98E63; color: white; padding: 8px 16px; border-radius: 20px; text-decoration: none; font-weight: bold; font-size: 0.9rem;" %>
        <% end %>
      </div>
    </header>
    <div class="container">
      <div id="flash_messages">
        <% if notice.present? %>
          <p class="flash flash--notice" style="color: green; background: #e6ffed; padding: 10px; border-radius: 5px;"><%= notice %></p>
        <% end %>
        <% if alert.present? %>
          <p class="flash flash--alert" style="color: red; background: #ffe6e6; padding: 10px; border-radius: 5px;"><%= alert %></p>
        <% end %>
      </div>

      <%= yield %>
    </div>
    <turbo-frame id="modal"></turbo-frame>
  </body>
</html>
