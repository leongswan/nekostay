<style>
  /* 星を横並びにして、順番を逆にする（右から左へ） 
     これがないと「選択した星より左側を光らせる」ことができません */
  .rating-box {
    display: flex;
    flex-direction: row-reverse;
    justify-content: center;
    gap: 5px;
  }

  /* ラジオボタン（丸いポチ）は隠す */
  .rating-box input {
    display: none;
  }

  /* 星のデザイン */
  .rating-box label {
    font-size: 40px;
    color: #ccc; /* 未選択の色（グレー） */
    cursor: pointer;
    transition: color 0.2s;
  }

  /* ホバーした星と、それより後ろ（見た目は左）にある星を光らせる */
  .rating-box label:hover,
  .rating-box label:hover ~ label {
    color: #D98E63; /* ホバー時の色 */
  }

  /* 選択（クリック）された星と、それより後ろ（見た目は左）にある星を光らせる */
  .rating-box input:checked ~ label {
    color: #D98E63; /* 決定時の色（オレンジ） */
  }
</style>

<div style="max-width: 600px; margin: 40px auto; padding: 20px;">
  
  <div style="margin-bottom: 20px;">
    <%= link_to stay_path(@stay), style: "text-decoration: none; color: #999; display: inline-flex; align-items: center; gap: 5px;" do %>
      <i class="fa-solid fa-arrow-left"></i> お世話詳細に戻る
    <% end %>
  </div>

  <div style="background: white; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.05); padding: 40px 30px; border: 1px solid #eee; text-align: center;">
    
    <div style="width: 80px; height: 80px; border-radius: 50%; background: #eee; margin: 0 auto 20px; overflow: hidden; border: 3px solid #fff; box-shadow: 0 4px 10px rgba(0,0,0,0.1);">
      <% if @stay.sitter.image.attached? %>
        <%= image_tag @stay.sitter.image, style: "width: 100%; height: 100%; object-fit: cover;" %>
      <% else %>
        <div style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; font-size: 40px;">👤</div>
      <% end %>
    </div>

    <h2 style="color: #5A4A42; margin: 0 0 10px 0;">
      <%= @stay.sitter.name %>さんへのレビュー
    </h2>
    <p style="color: #999; font-size: 0.9rem; margin-bottom: 30px;">
      お世話はいかがでしたか？<br>率直な感想をお聞かせください。
    </p>

    <%= form_with(model: [@stay, @review], local: true) do |f| %>
      
      <div style="margin-bottom: 30px;">
        <div style="font-weight: bold; color: #5A4A42; margin-bottom: 10px;">評価（星をクリック）</div>
        
        <div class="rating-box">
          <%= f.radio_button :score, 5, id: 'star5' %>
          <label for="star5" title="最高！">★</label>
          
          <%= f.radio_button :score, 4, id: 'star4' %>
          <label for="star4" title="良かった">★</label>
          
          <%= f.radio_button :score, 3, id: 'star3' %>
          <label for="star3" title="普通">★</label>
          
          <%= f.radio_button :score, 2, id: 'star2' %>
          <label for="star2" title="微妙...">★</label>
          
          <%= f.radio_button :score, 1, id: 'star1' %>
          <label for="star1" title="悪い">★</label>
        </div>
      </div>

      <div style="margin-bottom: 30px; text-align: left;">
        <%= f.label :comment, "💬 コメント・感想", style: "display: block; font-weight: bold; margin-bottom: 8px; color: #555;" %>
        <%= f.text_area :comment, rows: 4, placeholder: "丁寧にお世話してくれて助かりました！またお願いします。", style: "width: 100%; padding: 15px; border: 1px solid #ddd; border-radius: 12px; font-size: 1rem; line-height: 1.6; box-sizing: border-box;" %>
      </div>

      <%= f.button "レビューを投稿する", type: "submit", style: "background: #D98E63; color: white; border: none; padding: 15px 50px; border-radius: 30px; font-weight: bold; font-size: 1rem; cursor: pointer; box-shadow: 0 4px 15px rgba(217, 142, 99, 0.3); transition: transform 0.1s;", onmousedown: "this.style.transform='scale(0.98)'", onmouseup: "this.style.transform='scale(1)'" %>

    <% end %>

  </div>
</div>